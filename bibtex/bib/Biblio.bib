@article{McClelland2013,
abstract = {The problem of respiratory motion has proved a serious obstacle in developing techniques to acquire images or guide interventions in abdominal and thoracic organs. Motion models offer a possible solution to these problems, and as a result the field of respiratory motion modelling has become an active one over the past 15years. A motion model can be defined as a process that takes some surrogate data as input and produces a motion estimate as output. Many techniques have been proposed in the literature, differing in the data used to form the models, the type of model employed, how this model is computed, the type of surrogate data used as input to the model in order to make motion estimates and what form this output should take. In addition, a wide range of different application areas have been proposed. In this paper we summarise the state of the art in this important field and in the process highlight the key papers that have driven its advance. The intention is that this will serve as a timely review and comparison of the different techniques proposed to date and as a basis to inform future research in this area.},
author = {McClelland, J.R. and Hawkes, D.J. and Schaeffter, T. and King, A.P.},
doi = {10.1016/J.MEDIA.2012.09.005},
issn = {1361-8415},
journal = {Medical Image Analysis},
month = {1},
number = {1},
pages = {19--42},
publisher = {Elsevier},
title = {{Respiratory motion models: A review}},
volume = {17},
year = {2013}
}
@article{Oliveira2014,
abstract = {This paper presents a review of automated image registration methodologies that have been used in the medical field. The aim of this paper is to be an introduction to the field, provide knowledge on the work that has been developed and to be a suitable reference for those who are looking for registration methods for a specific application. The registration methodologies under review are classified into intensity or feature based. The main steps of these methodologies, the common geometric transformations, the similarity measures and accuracy assessment techniques are introduced and described.},
author = {Oliveira, Francisco P.M. and Tavares, Jo{\~{a}}o Manuel R.S.},
doi = {10.1080/10255842.2012.670855},
issn = {1025-5842},
journal = {Computer Methods in Biomechanics and Biomedical Engineering},
keywords = {computational methods,geometrical transformations,image alignment, matching, warping,image analysis,optimisation,similarity measures},
month = {1},
number = {2},
pages = {73--93},
publisher = {Taylor {\&} Francis},
title = {{Medical image registration: a review}},
volume = {17},
year = {2014}
}
@article{Nehmeh2008,
abstract = {The development of positron emission tomography/computed tomography (PET/CT) scanners has allowed not only straightforward but also synergistic fusion of anatomical and functional information. Combined PET/CT imaging yields an increased sensitivity and specificity beyond that which either of the 2 modalities possesses separately and therefore provides improved diagnostic accuracy. Because attenuation correction in PET is performed with the use of CT images, with CT used in the localization of disease, accurate spatial registration of PET and CT image sets is required. Correcting for the spatial mismatch caused by respiratory motion represents a particular challenge for the requisite registration accuracy as a result of differences in temporal resolution between the 2 modalities. This review provides a brief summary of the materials, methods, and results involved in multiple investigations of the correction for respiratory motion in PET/CT imaging of the thorax, with the goal of improving image quality and quantitation. Although some schemes use respiratory-phase data selection to exclude motion artifacts, others have adopted sophisticated software techniques. The various image artifacts associated with breathing motion are also described.},
author = {Nehmeh, Sadek A. and Erdi, Yusuf E.},
issn = {0001-2998},
journal = {Seminars in Nuclear Medicine},
month = {5},
number = {3},
pages = {167--176},
publisher = {W.B. Saunders},
title = {{Respiratory Motion in Positron Emission Tomography/Computed Tomography: A Review}},
volume = {38},
year = {2008}
}
@article{Thielemans2012,
author = {Thielemans, Kris and Tsoumpas, Charalampos and Mustafovic, Sanida and Beisel, Tobias and Aguiar, Pablo and Dikaios, Nikolaos and Jacobson, Matthew W},
issn = {0031-9155},
journal = {Physics in Medicine and Biology},
month = {2},
number = {4},
pages = {867--883},
publisher = {IOP Publishing},
title = {{STIR: software for tomographic image reconstruction release 2}},
volume = {57},
year = {2012}
}
@article{Visvikis2006,
abstract = {The effect of physiological motion in emission tomography is a reduction in overall image contrast and loss of sensitivity. In particular, respiratory motion affects imaging in the thoracic and the upper abdomen area, leading to a reduction in lesion detection as a result of the associated blurring. Furthermore, respiratory motion leads to a compromise in quantitative accuracy in terms of functional volume determination and activity concentration recovery for oncology imaging. This paper presents a review of the current state of the art in the implementation of respiratory motion compensation techniques in positron emission tomography (PET) imaging for oncology applications.},
author = {Visvikis, D. and Lamare, F. and Bruyant, P. and Boussion, N. and {Cheze Le Rest}, C.},
issn = {0168-9002},
journal = {Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment},
month = {12},
number = {2},
pages = {453--457},
publisher = {North-Holland},
title = {{Respiratory motion in positron emission tomography for oncology applications: Problems and solutions}},
volume = {569},
year = {2006}
}
@article{Efthimiou2018,
author = {Efthimiou, Nikos and Emond, Elise and Wadhwa, Palak and Cawthorne, Chris and Tsoumpas, Charalampos and Thielemans, Kris},
issn = {0031-9155},
journal = {Physics in Medicine and Biology},
publisher = {IOP Publishing},
title = {{Implementation and validation of time-of-flight PET image reconstruction module for listmode and sinogram projection data in the STIR library}},
year = {2019},
number = {3}, 
month = {1}, 
pages = {035004}, 
volume = {64}, 
doi = {10.1088/1361-6560/aaf9b9}
}
@inproceedings{Ovtchinnikov2017,
author = {Ovtchinnikov, Evgueni and Atkinson, David and Kolbitsch, Christoph and Thomas, Benjamin A. and Bertolli, Ottavia and da Costa-Luis, Casper O. and Efthimiou, Nikolaos and Fowler, Ronald and Pasca, Edoardo and Wadhwa, Palak and Emond, Elise and Matthews, Julian and Prieto, Claudia and Reader, Andrew J. and Tsoumpas, Charalampos and Turner, Martin and Thielemans, Kris},
booktitle = {2017 IEEE Nuclear Science Symposium and Medical Imaging Conference (NSS/MIC)},
isbn = {978-1-5386-2282-7},
month = {10},
pages = {1--3},
publisher = {IEEE},
title = {{SIRF: Synergistic Image Reconstruction Framework}},
year = {2017}
}
@software{ovtchinnikov_evgueni_2019_3548719,
  author       = {Ovtchinnikov, Evgueni and
                  Brown, Richard and
                  Thielemans, Kris and
                  Pasca, Edoardo and
                  da Costa-Luis, Casper O. and
                  Thomas, Ben and
                  Atkinson, David and
                  Mayer, Johannes and
                  Gillman, Ashley and
                  Kolbitsch, Christoph and
                  Ehrhardt, Matthias J. and
                  Whitehead, Alexander},
  title        = {{SIRF}: {Synergistic} {Image} {Reconstruction} {Framework}},
  month        = nov,
  year         = 2019,
  publisher    = {Zenodo},
  version      = {v2.1.0},
  doi          = {10.5281/zenodo.3548719},
  url          = {https://doi.org/10.5281/zenodo.3548719}
}
@article{ovtchinnikov2019SIRFSynergisticImage,
	title = {{SIRF}: {Synergistic} {Image} {Reconstruction} {Framework}},
	issn = {0010-4655},
	shorttitle = {{SIRF}},
	url = {http://www.sciencedirect.com/science/article/pii/S0010465519303984},
	doi = {10.1016/j.cpc.2019.107087},
	abstract = {The combination of positron emission tomography (PET) with magnetic resonance (MR) imaging opens the way to more accurate diagnosis and improved patient management. At present, the data acquired by PET-MR scanners are essentially processed separately, but the opportunity to improve accuracy of the tomographic reconstruction via synergy of the two imaging techniques is an active area of research. In this paper, we present Release 2.1.0 of the CCP-PETMR Synergistic Image Reconstruction Framework (SIRF) software suite, providing an open-source software platform for efficient implementation and validation of novel reconstruction algorithms. SIRF provides user-friendly Python and MATLAB interfaces built on top of C++ libraries. SIRF uses advanced PET and MR reconstruction software packages and tools. Currently, for PET this is Software for Tomographic Image Reconstruction (STIR); for MR, Gadgetron and ISMRMRD; and for image registration tools, NiftyReg. The software aims to be capable of reconstructing images from acquired scanner data, whilst being simple enough to be used for educational purposes. The most recent version of the software can be downloaded from http://www.ccppetmr.ac.uk/downloads and https://github.com/CCPPETMR/.
Program summary
Program Title: Synergistic Image Reconstruction Framework (SIRF) Program Files doi: http://dx.doi.org/10.17632/s45f5jh55j.1 Licensing provisions: GPLv3 and Apache-2.0 Programming languages: C++, C, Python, MATLAB Nature of problem: In current practice, data acquired by PET-MR scanners are processed separately. Methods for improving the accuracy of the tomographic reconstruction using the synergy of the two imaging techniques are actively being investigated by the PET-MR research and development community, however, practical application is heavily reliant on software. Open-source software available to the PET-MR community – such as the PET package (STIR) (Thielemans et al., 2012) and the MR package Gadgetron (Hansen and Sørensen, 2013) – provide a basis for new synergistic PET-MR software. However, these two software packages are independent and have very different software architectures. They are mostly written in C++ but many researchers in the PET-MR community are more familiar with script-style languages, such as Python and MATLAB, which enable rapid prototyping of novel reconstruction algorithms. In the current situation it is difficult for researchers to exploit any synergy between PET and MR data. Furthermore, techniques from one field cannot easily be applied in the other. Solution method: In SIRF, the bulk of computation is performed by available advanced open-source reconstruction and registration software (currently STIR, Gadgetron and NiftyReg) that can use multithreading and GPUs. The SIRF C++ code provides a thin layer on top of these existing libraries. The SIRF layer has unified data-containers and access mechanisms. This C++ layer provides the basis for a simple and intuitive Python and MATLAB interface, enabling users to quickly develop and test their reconstruction algorithms using these scripting languages only. At the same time, advanced users proficient in C++ can directly utilise wider SIRF functionality via the SIRF C++ libraries that we provide.},
	language = {en},
	urldate = {2019-12-11},
	journal = {Computer Physics Communications},
	author = {Ovtchinnikov, Evgueni and Brown, Richard and Kolbitsch, Christoph and Pasca, Edoardo and da Costa-Luis, Casper and Gillman, Ashley G. and Thomas, Benjamin A. and Efthimiou, Nikos and Mayer, Johannes and Wadhwa, Palak and Ehrhardt, Matthias J. and Ellis, Sam and Jørgensen, Jakob S. and Matthews, Julian and Prieto, Claudia and Reader, Andrew J. and Tsoumpas, Charalampos and Turner, Martin and Atkinson, David and Thielemans, Kris},
	month = dec,
	year = {2019},
	pages = {107087}
}
@article{Mehranian2015,
author = {Mehranian, A. and Zaidi, H.},
issn = {0161-5505},
journal = {Journal of Nuclear Medicine},
month = {4},
number = {4},
pages = {635--641},
title = {{Impact of Time-of-Flight PET on Quantification Errors in MR Imaging-Based Attenuation Correction}},
volume = {56},
year = {2015}
}
@article{McClelland2011,
abstract = {Respiratory motion can vary dramatically between the planning stage and the different fractions of radiotherapy treatment. Motion predictions used when constructing the radiotherapy plan may be unsuitable for later fractions of treatment. This paper presents a methodology for constructing patient-specific respiratory motion models and uses these models to evaluate and analyse the inter-fraction variations in the respiratory motion. The internal respiratory motion is determined from the deformable registration of Cine CT data and related to a respiratory surrogate signal derived from 3D skin surface data. Three different models for relating the internal motion to the surrogate signal have been investigated in this work. Data were acquired from six lung cancer patients. Two full datasets were acquired for each patient, one before the course of radiotherapy treatment and one at the end (approximately 6 weeks later). Separate models were built for each dataset. All models could accurately predict the respiratory motion in the same dataset, but had large errors when predicting the motion in the other dataset. Analysis of the inter-fraction variations revealed that most variations were spatially varying base-line shifts, but changes to the anatomy and the motion trajectories were also observed.},
author = {McClelland, J R and Hughes, S and Modat, M and Qureshi, A and Ahmad, S and Landau, D B and Ourselin, S and Hawkes, D J},
issn = {0031-9155},
journal = {Physics in Medicine and Biology},
month = {1},
number = {1},
pages = {251--272},
pmid = {21149951},
title = {{Inter-fraction variations in respiratory motion models}},
volume = {56},
year = {2011}
}
@incollection{McClelland2014,
author = {McClelland, Jamie R. and Champion, Benjamin A. S. and Hawkes, David J.},
doi = {10.1007/978-3-319-08554-8_11},
pages = {103--113},
publisher = {Springer, Cham},
title = {{Combining Image Registration, Respiratory Motion Modelling, and Motion Compensated Image Reconstruction}},
year = {2014}
}
@article{McClelland2017,
abstract = {Surrogate-driven respiratory motion models relate the motion of the internal anatomy to easily acquired respiratory surrogate signals, such as the motion of the skin surface. They are usually built by first using image registration to determine the motion from a number of dynamic images, and then fitting a correspondence model relating the motion to the surrogate signals. In this paper we present a generalized framework that unifies the image registration and correspondence model fitting into a single optimization. This allows the use of 'partial' imaging data, such as individual slices, projections, or k-space data, where it would not be possible to determine the motion from an individual frame of data. Motion compensated image reconstruction can also be incorporated using an iterative approach, so that both the motion and a motion-free image can be estimated from the partial image data. The framework has been applied to real 4DCT, Cine CT, multi-slice CT, and multi-slice MR data, as well as simulated datasets from a computer phantom. This includes the use of a super-resolution reconstruction method for the multi-slice MR data. Good results were obtained for all datasets, including quantitative results for the 4DCT and phantom datasets where the ground truth motion was known or could be estimated.},
author = {McClelland, Jamie R and Modat, Marc and Arridge, Simon and Grimes, Helen and D'Souza, Derek and Thomas, David and Connell, Dylan O' and Low, Daniel A and Kaza, Evangelia and Collins, David J and Leach, Martin O and Hawkes, David J},
issn = {0031-9155},
journal = {Physics in Medicine and Biology},
month = {6},
number = {11},
pages = {4273--4292},
pmid = {28195833},
title = {{A generalized framework unifying image registration and respiratory motion models and incorporating image reconstruction, for partial image data or full images}},
volume = {62},
year = {2017}
}
@article{Ter-Pogossian1981,
abstract = {In positron emission tomography (PET), the annihilation radiation is usually detected as a coincidence occurrence that localizes the position of the annihilation event to a straight line joining the detectors. The measure of the difference between the time of flight (TOF) of the annihilation photons between their inception and their detection permits the localization of the position of the annihilation event along the coincidence line. The incorporation of TOF information into the PET reconstruction process improves the signal-to-noise ratio in the image obtained. The utilization of scintillation detectors utilizing cesium fluoride scintillators, fast photomultiplier tubes, and fast timing circuits allows sub-nanosecond coincidence timing resolution needed for the effective use of TOF in PET. Mathematical considerations and pilot experiments show that with state-of-the-art electronic components and through the application of proper reconstruction algorithms, the combination of TOF and PET positional data improves severalfold the signal-to-noise ratio with respect to conventional PET image reconstruction at the cost of increasing the amount of data to be processed. The construction of a TOF-assisted PET device is within the capability of state-of-the-art technology.},
author = {Ter-Pogossian, M M and Mullani, N A and Ficke, D C and Markham, J and Snyder, D L},
issn = {0363-8715},
journal = {Journal of computer assisted tomography},
keywords = {Electronics, Medical,Models, Theoretical,Scintillation Counting,Time Factors,Tomography, Emission-Computed},
month = {4},
number = {2},
pages = {227--39},
pmid = {6971303},
title = {{Photon time-of-flight-assisted positron emission tomography.}},
volume = {5},
year = {1981}
}
@article{Bousse2016,
abstract = {This work is an extension of our recent work on joint activity reconstruction/motion estimation (JRM) from positron emission tomography (PET) data. We performed JRM by maximization of the penalized log-likelihood in which the probabilistic model assumes that the same motion field affects both the activity distribution and the attenuation map. Our previous results showed that JRM can successfully reconstruct the activity distribution when the attenuation map is misaligned with the PET data, but converges slowly due to the significant cross-talk in the likelihood. In this paper, we utilize time-of-flight PET for JRM and demonstrate that the convergence speed is significantly improved compared to JRM with conventional PET data.},
author = {Bousse, Alexandre and Bertolli, Ottavia and Atkinson, David and Arridge, Simon and Ourselin, S{\'{e}}bastien and Hutton, Brian F and Thielemans, Kris},
issn = {0031-9155},
journal = {Physics in Medicine and Biology},
month = {2},
number = {3},
pages = {L11--L19},
pmid = {26789205},
title = {{Maximum-likelihood joint image reconstruction and motion estimation with misaligned attenuation in TOF-PET/CT}},
volume = {61},
year = {2016}
}
@misc{NiftyRegResp,
title = {{Jamie Mcclelland / NiftyRegResp {\textperiodcentered} GitLab}},
url = {https://cmiclab.cs.ucl.ac.uk/jmcclelland/NiftyRegResp},
urldate = {2019-04-27}
}
@article{Hudson1994,
abstract = {The authors define ordered subset processing for standard algorithms (such as expectation maximization, EM) for image restoration from projections. Ordered subsets methods group projection data into an ordered sequence of subsets (or blocks). An iteration of ordered subsets EM is defined as a single pass through all the subsets, in each subset using the current estimate to initialize application of EM with that data subset. This approach is similar in concept to block-Kaczmarz methods introduced by Eggermont et al. (1981) for iterative reconstruction. Simultaneous iterative reconstruction (SIRT) and multiplicative algebraic reconstruction (MART) techniques are well known special cases. Ordered subsets EM (OS-EM) provides a restoration imposing a natural positivity condition and with close links to the EM algorithm. OS-EM is applicable in both single photon (SPECT) and positron emission tomography (PET). In simulation studies in SPECT, the OS-EM algorithm provides an order-of-magnitude acceleration over EM, with restoration quality maintained.},
author = {Hudson, H.M. and Larkin, R.S.},
issn = {02780062},
journal = {IEEE Transactions on Medical Imaging},
number = {4},
pages = {601--609},
pmid = {18218538},
title = {{Accelerated image reconstruction using ordered subsets of projection data}},
volume = {13},
year = {1994}
}
@article{Segars2009,
author = {Segars, W. Paul and Tsui, Benjamin M. W.},
issn = {0018-9219},
journal = {Proceedings of the IEEE},
month = {12},
number = {12},
pages = {1954--1968},
title = {{MCAT to XCAT: The Evolution of 4-D Computerized Phantoms for Imaging Research}},
volume = {97},
year = {2009}
}
@article{Bousse2016a,
abstract = {This work provides an insight into positron emission tomography (PET) joint image reconstruction/motion estimation (JRM) by maximization of the likelihood, where the probabilistic model accounts for warped attenuation. Our analysis shows that maximum-likelihood (ML) JRM returns the same reconstructed gates for any attenuation map ($\mu$-map) that is a deformation of a given $\mu$-map, regardless of its alignment with the PET gates. We derived a joint optimization algorithm accordingly, and applied it to simulated and patient gated PET data. We first evaluated the proposed algorithm on simulations of respiratory gated PET/CT data based on the XCAT phantom. Our results show that independently of which $\mu$-map is used as input to JRM: (i) the warped $\mu$-maps correspond to the gated $\mu$-maps, (ii) JRM outperforms the traditional post-registration reconstruction and consolidation (PRRC) for hot lesion quantification and (iii) reconstructed gated PET images are similar to those obtained with gated $\mu$-maps. This suggests that a breath-held $\mu$-map can be used. We then applied JRM on patient data with a $\mu$-map derived from a breath-held high resolution CT (HRCT), and compared the results with PRRC, where each reconstructed PET image was obtained with a corresponding cine-CT gated $\mu$-map. Results show that JRM with breath-held HRCT achieves similar reconstruction to that using PRRC with cine-CT. This suggests a practical low-dose solution for implementation of motion-corrected respiratory gated PET/CT.},
author = {Bousse, Alexandre and Bertolli, Ottavia and Atkinson, David and Arridge, Simon and Ourselin, Sebastien and Hutton, Brian F. and Thielemans, Kris},
issn = {0278-0062},
journal = {IEEE Transactions on Medical Imaging},
month = {1},
number = {1},
pages = {217--228},
pmid = {26259017},
title = {{Maximum-Likelihood Joint Image Reconstruction/Motion Estimation in Attenuation-Corrected Respiratory Gated PET/CT Using a Single Attenuation Map}},
volume = {35},
year = {2016}
}
@article{Segars2010,
abstract = {PURPOSE The authors develop the 4D extended cardiac-torso (XCAT) phantom for multimodality imaging research. METHODS Highly detailed whole-body anatomies for the adult male and female were defined in the XCAT using nonuniform rational B-spline (NURBS) and subdivision surfaces based on segmentation of the Visible Male and Female anatomical datasets from the National Library of Medicine as well as patient datasets. Using the flexibility of these surfaces, the Visible Human anatomies were transformed to match body measurements and organ volumes for a 50th percentile (height and weight) male and female. The desired body measurements for the models were obtained using the PEOPLESIZE program that contains anthropometric dimensions categorized from 1st to the 99th percentile for US adults. The desired organ volumes were determined from ICRP Publication 89 [ICRP, "Basic anatomical and physiological data for use in radiological protection: reference values," ICRP Publication 89 (International Commission on Radiological Protection, New York, NY, 2002)]. The male and female anatomies serve as standard templates upon which anatomical variations may be modeled in the XCAT through user-defined parameters. Parametrized models for the cardiac and respiratory motions were also incorporated into the XCAT based on high-resolution cardiac- and respiratory-gated multislice CT data. To demonstrate the usefulness of the phantom, the authors show example simulation studies in PET, SPECT, and CT using publicly available simulation packages. RESULTS As demonstrated in the pilot studies, the 4D XCAT (which includes thousands of anatomical structures) can produce realistic imaging data when combined with accurate models of the imaging process. With the flexibility of the NURBS surface primitives, any number of different anatomies, cardiac or respiratory motions or patterns, and spatial resolutions can be simulated to perform imaging research. CONCLUSIONS With the ability to produce realistic, predictive 3D and 4D imaging data from populations of normal and abnormal patients under various imaging parameters, the authors conclude that the XCAT provides an important tool in imaging research to evaluate and improve imaging devices and techniques. In the field of x-ray CT, the phantom may also provide the necessary foundation with which to optimize clinical CT applications in terms of image quality versus radiation dose, an area of research that is becoming more significant with the growing use of CT.},
author = {Segars, W. P. and Sturgeon, G. and Mendonca, S. and Grimes, Jason and Tsui, B. M. W.},
doi = {10.1118/1.3480985},
issn = {00942405},
journal = {Medical Physics},
month = {8},
number = {9},
pages = {4902--4915},
pmid = {20964209},
title = {{4D XCAT phantom for multimodality imaging research}},
volume = {37},
year = {2010}
}
@article{WenjiaBai2011,
author = {{Wenjia Bai} and Brady, Michael},
doi = {10.1109/TMI.2010.2078514},
issn = {0278-0062},
journal = {IEEE Transactions on Medical Imaging},
month = {2},
number = {2},
pages = {351--365},
title = {{Motion Correction and Attenuation Correction for Respiratory Gated PET Images}},
volume = {30},
year = {2011}
}